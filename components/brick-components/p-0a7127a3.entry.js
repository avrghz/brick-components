import{r as t,h as i,c as s,g as o}from"./p-dd77af2d.js";import"./p-195bd1cc.js";import{c as n}from"./p-93ed5897.js";const e=(t,i)=>i?t.findIndex(t=>i===t.value):-1,r=t=>!!t.find(t=>!t.disabled),d=t=>t.findIndex(t=>!t.disabled),h=class{constructor(o){t(this,o),this.searchText="",this.options=[],this.disabled=!1,this.searchable=!1,this.noOptionText="No option",this.setOptions=()=>{try{this._options="string"==typeof this.options?JSON.parse(this.options):this.options}catch(t){this.options=[]}},this.validateSelectedOption=()=>{this.selectedOption&&this._options.find(t=>t.value===this.selectedOption&&t.disabled)&&(this.selectedOption=void 0,n("DropdownList","Cannot set disabled option as selected"))},this.setFocus=t=>{this.selectedOption=this._options[t].value,this.el.querySelector("#option_"+t).focus()},this.handleMenuKeydown=t=>{switch(!0){case"Home"===t.detail:((t,i)=>{const s=d(this._options);-1!==s&&i(s)})(0,this.setFocus);break;case"End"===t.detail:((t,i)=>{const s=d([...t].reverse());-1!==s&&i(t.length-1-s)})(this._options,this.setFocus);break;case"ArrowDown"===t.detail:this.selectedOption&&((t,i,s)=>{if(!r(t))return;const o=e(t,i),n=-1===o?0:o+1;let d=-1;for(let e=n;e<t.length;e++)if(!t[e].disabled){d=e;break}if(-1===d)for(let e=0;e<n;e++)if(!t[e].disabled){d=e;break}-1!==d&&s(d)})(this._options,this.selectedOption,this.setFocus);break;case"ArrowUp"===t.detail:this.selectedOption&&((t,i,s)=>{if(!r(t))return;const o=e(t,i),n=-1===o?t.length-1:o-1;let d=-1;for(let e=n;e>=0;e--)if(!t[e].disabled){d=e;break}if(-1===d)for(let e=t.length-1;e>n;e--)if(!t[e].disabled){d=e;break}-1!==d&&s(d)})(this._options,this.selectedOption,this.setFocus)}},this.handleMenuOpen=()=>{var t;this.searchable&&this.searchBar&&this.searchBar.focus(),null===(t=this.dropdown)||void 0===t||t.addEventListener("bkMenuKeydown",this.handleMenuKeydown)},this.onOptionSelect=(t,i)=>{t.stopImmediatePropagation(),this.searchText="",this.bkSelect.emit(i),this.dropdown&&this.dropdown.dispatchEvent(new Event("bkCloseDropdownMenu",{bubbles:!1}))},this.onOptionClickHandler=(t,i,s)=>{this.selectedOption&&i.value===this.selectedOption||(this.setFocus(s),this.onOptionSelect(t,i))},this.onOptionKeydownHandler=(t,i)=>{"Enter"===t.key&&this.onOptionSelect(t,i)},this.onSearchKeyDown=t=>{"Home"!==t.key&&"End"!==t.key&&"ArrowDown"!==t.key&&"ArrowUp"!==t.key&&"Escape"!==t.key&&t.stopImmediatePropagation()},this.onSearchInput=t=>{this.searchText=t.target.value},this.onClearClick=t=>{t.stopImmediatePropagation(),this.searchText=""},this.searchBarUI=()=>!!this.searchable&&i("div",{class:`bk-input bk-input--small bk-input--prefix ${this.searchText?"bk-input--suffix":""} bk-dropdown-list__search`},i("input",{type:"text",placeholder:"Search",class:"bk-input__inner",value:this.searchText,ref:t=>this.searchBar=t,onInput:this.onSearchInput,onKeyDown:this.onSearchKeyDown}),i("span",{class:"bk-input__prefix"},i("iron-icon",{icon:"search",class:"bk-icon bk-icon--sm"})),!!this.searchText&&i("button",{class:"bk-button bk-button--mini bk-button--text bk-input__suffix bk-dropdown-list__icon bk-dropdown-list__close-btn",onClick:this.onClearClick},i("iron-icon",{icon:"close",class:"bk-icon bk-icon--sm"}))),this.listUI=()=>i("ul",{class:"bk-dropdown-list__list",role:"listbox"},this._options.map((t,s)=>i("li",{key:s,id:"option_"+s,class:"bk-dropdown-list__item "+(t.disabled?"is-disabled":this.selectedOption&&this.selectedOption===t.value?"is-active":""),role:"option",tabIndex:-1,onClick:i=>this.onOptionClickHandler(i,t,s),onKeyDown:i=>this.onOptionKeydownHandler(i,t),title:t.label},t.label))),this.bkSelect=s(this,"bkSelect",7)}watchOptions(){this.setOptions()}watchSelectedOption(){this.validateSelectedOption()}watchSearch(t,i){t&&t!==i?this._options=this._options.filter(t=>t.label.indexOf(this.searchText)>-1):i&&!t&&this.setOptions()}componentWillLoad(){this.setOptions(),this.validateSelectedOption()}render(){return i("bk-dropdown",{disabled:this.disabled,onBkOpened:this.handleMenuOpen,ref:t=>this.dropdown=t},i("slot",{name:"control"}),i("div",{slot:"content",class:"bk-dropdown-list__content",tabIndex:-1},this.searchBarUI(),this._options.length>0?this.listUI():i("div",{class:"bk-dropdown-list__no-option"},this.noOptionText)))}get el(){return o(this)}static get watchers(){return{options:["watchOptions"],selectedOption:["watchSelectedOption"],searchText:["watchSearch"]}}};h.style='.bk-dropdown-list__content.sc-bk-dropdown-list{min-width:200px;outline:none}.bk-dropdown-list__no-option.sc-bk-dropdown-list{color:#909399;text-align:center;margin-top:10px}.bk-dropdown-list__search.sc-bk-dropdown-list{margin-bottom:5px}.bk-dropdown-list__list.sc-bk-dropdown-list{padding:0;margin:0 -20px;max-height:250px;overflow-y:auto}.bk-dropdown-list__item.sc-bk-dropdown-list{display:block;list-style:none;line-height:30px;padding:0 20px;margin:0;font-size:14px;color:#606266;cursor:pointer;outline:none;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.bk-dropdown-list__item.sc-bk-dropdown-list:not(.is-disabled):not(:focus):not(.is-active):hover{background-color:#ecf5ff;color:#66b1ff}.bk-dropdown-list__item.is-active.sc-bk-dropdown-list{background-color:#409eff;color:#ffffff}.bk-dropdown-list__item--divided.sc-bk-dropdown-list{position:relative;margin-top:6px;border-top:1px solid #ebeef5}.bk-dropdown-list__item--divided.sc-bk-dropdown-list:before{content:"";height:6px;display:block;margin:0 -20px;background-color:#ffffff}.bk-dropdown-list__item.is-disabled.sc-bk-dropdown-list{cursor:default;color:#bbb;pointer-events:none}.bk-dropdown-list__close-btn.sc-bk-dropdown-list{pointer-events:all}';export{h as bk_dropdown_list}