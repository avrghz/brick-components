import{r as t,h as i,g as a}from"./p-6bd26c3b.js";const s=class{constructor(i){t(this,i),this.is=(t,i)=>"bgImage"===t?i.hasAttribute("data-bg-image"):i.tagName.toLocaleLowerCase()===t,this.resolveImageSource=t=>new Promise((i,a)=>{const s=new Image;s.onload=()=>i(t),s.onerror=()=>a(),s.src=t}),this.setSrc=async(t,i)=>{if(t){const a=t.getAttribute("data-src")||"";t.src=i?a:await this.resolveImageSource(a)}},this.setSrcset=async t=>{t&&t.forEach(t=>t.srcset=t.getAttribute("data-srcset")||"")},this.setVideoSrc=async t=>{t&&t.forEach(t=>t.src=t.getAttribute("data-src")||"")},this.setBackground=async(t,i)=>{if(t){const a=(t.getAttribute("data-bg-image")||"").split(",");i||await this.resolveImageSource(a[0]),t.style.backgroundImage=`url('${a.join("'),url('")}')`}},this.loadMedia=async(t,i=!1)=>{try{this.is("img",t)?await this.setSrc(t,i):this.is("picture",t)?(await this.setSrc(t.querySelector("img"),i),await this.setSrcset(t.querySelectorAll("source"))):this.is("bgImage",t)?await this.setBackground(t,i):this.is("video",t)&&(await this.setVideoSrc(t.querySelectorAll("source")),t.load())}catch(a){}t.setAttribute("data-loaded","true")},this.createObserver=()=>new IntersectionObserver(async(t,i)=>{t.forEach(async t=>{t.isIntersecting&&!t.target.hasAttribute("data-loaded")&&(i.unobserve(t.target),await this.loadMedia(t.target))})},{threshold:0})}componentWillLoad(){this.elements=this.el.querySelectorAll("img, video, picture, [data-bg-image]"),"undefined"!=typeof window&&window.IntersectionObserver&&(this.observer=this.createObserver())}async componentDidLoad(){this.elements&&this.elements.forEach(async t=>{this.observer?this.observer.observe(t):await this.loadMedia(t,!0)})}disconnectedCallback(){this.elements&&this.elements.forEach(async t=>{this.observer&&this.observer.unobserve(t)})}render(){return i("slot",null)}get el(){return a(this)}};s.style="bk-lazy-media{overflow:hidden;position:relative;display:block}bk-lazy-media img{transition:all 0.5s ease-in-out;transform:scale(1.1);width:100%;filter:blur(5px)}bk-lazy-media img[data-loaded]{max-width:100%;transform:scale(1);filter:blur(0);min-height:auto}";export{s as bk_lazy_media};